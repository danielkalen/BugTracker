!function($,t,e,i){EventPlayback={version:"0.0.3"},$.recordEvents=function(t,e){return e&&(t.finished=e),new EventRecorder(t).start()},$.playbackEvents=function(t,e,i){return i&&(e.finished=i),new EventPlayer(t,e).start()},EventRecorder=function(t){this.frames=[],this.options=$.extend({dom:$(e),delay:500},t||{})},EventRecorder.prototype={encodeJSON:function(t){if(!t)return"null";switch(t.constructor){case String:return'"'+t.replace(/"/gm,'\\"')+'"';case Number:return t.toString();case Array:var e=[];for(var i in t)e.push(this.encodeJSON(t[i]));return"["+e.join(",")+"]";case Object:var n=[];for(var s in t)n.push(s+":"+this.encodeJSON(t[s]));return"{"+n.join(", ")+"}";default:return"null"}},exportJSON:function(){if(this.running)throw"EventRecorder: cannot export while running";return"("+this.encodeJSON({frames:this.frames})+")"},packFrame:function(t){return{x:t.pageX,y:t.pageY,type:t.type,target:this.getElementXPath(t.target),value:"change"===t.type?$(t.target).val():null}},getElementXPath:function(t){for(segs=[];t&&1===t.nodeType;t=t.parentNode){if(t.hasAttribute("id"))return segs.unshift('id("'+t.getAttribute("id")+'")'),segs.join("/");if(t.hasAttribute("class"))segs.unshift(t.localName.toLowerCase()+'[@class="'+t.getAttribute("class")+'"]');else{for(var e=1,i=t.previousSibling;i;i=i.previousSibling)i.localName===t.localName&&e++;segs.unshift(t.localName.toLowerCase()+"["+e+"]")}}return segs.length?"/"+segs.join("/"):null},startRecording:function(){var t=this,e;return $.each(["click","mousemove","change"],function(i,n){t.options.dom.bind(n,function(i){t.running&&(i.pageX||(i.pageX=e.x,i.pageY=e.y),e=t.packFrame(i),t.frames.push(e))})}),this},stop:function(){return this.running=!1,this.options.finished instanceof Function&&this.options.finished.call(this),this},start:function(){var t=this;return setTimeout(function(){t.running=!0,t.startRecording(),t.options.duration&&setTimeout(function(){t.stop()},t.options.duration),$window.on("unload beforeunload",function(){t.stop()})},this.options.delay),this}},EventPlayer=function(t,e){this.session=t,this.options=$.extend({dom:$("body"),trigger:!0,interval:25},e||{})},EventPlayer.prototype={unpackFrame:function(t){return t.xpath=t.target,t.target=$(this.getElementByXPath(t.target)),t},getElementByXPath:function(t){return result=e.evaluate(t,e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null),result.singleNodeValue},playFrame:function(t){var e=this;switch(isNewPath=this.lastPath!==t.xpath,this.cursor.css({left:t.x,top:t.y}),trigger=function(i){e.trigger(i,t.target)},triggerLast=function(t){e.trigger(t,$(e.getElementByXPath(e.lastPath)))},t.type){case"click":this.cursor.addClass("clicking"),this.showDisc(),trigger("click");break;case"mousemove":trigger("mouseover"),isNewPath&&triggerLast("mouseout");break;case"change":trigger("change"),t.target.val(t.value)}return this.cursor.hasClass("clicking")&&(this.cursor.removeClass("clicking"),this.hideDisc()),this.lastPath=t.xpath,this},trigger:function(t,e){return this.options.trigger&&e&&e.trigger(t),this},showDisc:function(t){return this.disc.addClass(t||"blue").fadeIn(80),this},hideDisc:function(){return this.disc.fadeOut(80,function(){$(this).removeClass("yellow").removeClass("blue").removeClass("red")}),this},play:function(){var t=this;return this.intervalID=setInterval(function(){(frame=t.session.frames.shift())?t.playFrame(t.unpackFrame(frame)):t.stop()},this.options.interval),this},removeCursor:function(){return $("#event-playback-cursor",this.dom).fadeOut("slow",function(){$(this).remove()}),this},displayCursor:function(){return this.cursor=$('<div id="event-playback-cursor"><div class="disc"></div></div>'),this.disc=$(".disc",this.cursor),this.options.dom.prepend(this.cursor),this.cursor.fadeIn("slow"),this},stop:function(){return this.running=!1,clearInterval(this.intervalID),this.removeCursor(),this.options.finished instanceof Function&&this.options.finished.call(this),this},start:function(){var t=this;return this.running=!0,this.play().displayCursor(),this.options.duration&&setTimeout(function(){t.stop()},this.options.duration),this}}}(jQuery,window,document);